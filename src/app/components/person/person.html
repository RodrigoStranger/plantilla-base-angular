<div class="container mt-4">
  <h1 class="text-center mb-4">Gestión de Personas</h1>

  <!-- Botón para abrir modal de crear persona -->
  <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#crearPersonaModal">
    + Crear Persona
  </button>

  <!-- Tabla de personas -->
  <table class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Edad</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      @for (persona of persons; track persona.id) {
        <tr>
          <td>{{ persona.id }}</td>
          <td>{{ persona.nombre }}</td>
          <td>{{ persona.apellido }}</td>
          <td>{{ persona.edad }}</td>
          <td>
            <!-- Botón editar -->
            <button class="btn btn-warning btn-sm me-2" (click)="abrirEditar(persona)">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-pencil-square" viewBox="0 0 16 16">
                <path
                  d="M15.502 1.94a.5.5 0 0 1 0 .706l-1 1a.5.5 0 0 1-.708 0l-1-1a.5.5 0 0 1 .708-.708l.647.646.647-.646a.5.5 0 0 1 .706 0z" />
                <path
                  d="M13.5 3.207L12.793 2.5 4 11.293V12h.707L13.5 3.207z" />
                <path fill-rule="evenodd"
                  d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-11A1.5 1.5 0 0 0 13.5 1h-11A1.5 1.5 0 0 0 1 2.5v11zm1-11A.5.5 0 0 1 2.5 2h11a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11z" />
              </svg>
            </button>

            <!-- Botón eliminar -->
            <button class="btn btn-danger btn-sm" (click)="abrirEliminar(persona)">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-trash" viewBox="0 0 16 16">
                <path
                  d="M5.5 5.5A.5.5 0 0 1 6 5h4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5H6a.5.5 0 0 1-.5-.5v-7z" />
                <path fill-rule="evenodd"
                  d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2h13v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
              </svg>
            </button>
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>

<!-- Modal Crear Persona (Static Backdrop) -->
<div class="modal fade" id="crearPersonaModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Crear Persona</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
  <form [formGroup]="crearForm" (ngSubmit)="createPerson()">
          <div class="mb-3">
            <label class="form-label">Nombre</label>
            <input type="text" formControlName="nombre" class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Apellido</label>
            <input type="text" formControlName="apellido" class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Edad</label>
            <input type="number" formControlName="edad" class="form-control" required>
          </div>
          <button type="submit" class="btn btn-primary" [disabled]="crearForm.invalid">Guardar</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Editar Persona (Static Backdrop) -->
<div class="modal fade" id="editarPersonaModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Persona</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
  <form [formGroup]="editarForm" (ngSubmit)="updatePerson()">
          <div class="mb-3">
            <label class="form-label">Nombre</label>
            <input type="text" formControlName="nombre" class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Apellido</label>
            <input type="text" formControlName="apellido" class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Edad</label>
            <input type="number" formControlName="edad" class="form-control" required>
          </div>
          <button type="submit" class="btn btn-primary" [disabled]="editarForm.invalid">Guardar Cambios</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Confirmar Eliminación (Static Backdrop) -->
<div class="modal fade" id="eliminarPersonaModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">Confirmar Eliminación</h5>
      </div>
      <div class="modal-body">
        ¿Estás seguro de eliminar a <strong>{{ personaSeleccionada?.nombre }} {{ personaSeleccionada?.apellido }}</strong>?
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn btn-danger" (click)="deletePerson()">Eliminar</button>
      </div>
    </div>
  </div>
</div>

